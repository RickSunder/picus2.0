{% extends "layout.html" %}

{% block title %}
    Groupview
{% endblock %}

{% block main %}
<head>
  <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<script>
        function get_group(pass_to_python)
    {
        var url = 'https://ide50-britt1212.legacy.cs50.io:8080/upload_photo?value='+pass_to_python;
        return window.open(url, "_self");
    }

    function leave_group(python)
    {
        var url_leave = 'https://ide50-britt1212.legacy.cs50.io:8080/leave_group?value='+python;
        return window.open(url_leave, "_self");
    }

    function like(photo, name)
    {
        var url_like = 'https://ide50-britt1212.legacy.cs50.io:8080/like_photo?value=' +photo + '&q=' +name;
        return window.open(url_like, "_self");
    }

    function dislike(photo, name)
    {
        var url_like = 'https://ide50-britt1212.legacy.cs50.io:8080/dislike_photo?value=' +photo + '&q=' +name;
        return window.open(url_like, "_self");
    }

    function bin(photo, name)
    {
        var user_choice = window.confirm('Are you sure you want to delete this ?');


        if(user_choice==true) {

        var url_like = 'https://ide50-britt1212.legacy.cs50.io:8080/bin?value=' +photo + '&q=' +name;
        return window.open(url_like, "_self");
        } else {
            return false;
        }
    }


    function add_group(groupl)
    {
        var url_like = 'https://ide50-britt1212.legacy.cs50.io:8080/add_member?value=' +groupl;
        return window.open(url_like, "_self");
    }
</script>
<h1 class="gecentreerd"style="color:white;"><fontsize="+15">{{ group }}</fontsize></h1>
<link href="https://fonts.googleapis.com/css?family=Rokkitt" rel="stylesheet">
		<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<br>
&nbsp;&nbsp;<input class="btn btn-light" style="font-size:15px; padding:10px; top:-225px" type="button" id="event" value="Upload photo" onclick="get_group('{{group}}')"/>
&nbsp;&nbsp;<input class="btn btn-light" style="font-size:15px; padding:10px; top:-225px" type="button" id="event" value="Leave group" onclick="leave_group('{{group}}')"/>
&nbsp;&nbsp;<input class="btn btn-light" style="font-size:15px; padding:10px; top:-225px" type="button" id="event" value="Add member" onclick="add_group('{{group}}')"/>

{% for row in list_picture %}
<section class="hero">
         <div class="container">
          <div class="row">

		   <div class="col-lg-6 offset-lg-3">

			<div class="cardbox shadow-lg bg-white">

			 <div class="cardbox-heading">
			  <!-- START dropdown-->
			  <div class="dropdown float-right">
			   <button class="btn btn-flat btn-flat-icon" type="button" data-toggle="dropdown" aria-expanded="false">
				<em class="fa fa-ellipsis-h"></em>
			   </button>
			   <div class="dropdown-menu dropdown-scale dropdown-menu-right" role="menu" style="position: absolute; transform: translate3d(-136px, 28px, 0px); top: 0px; left: 0px; will-change: transform;">
				<a class="dropdown-item" onclick="bin('{{row[3]}}', '{{ group}}')">Delete post</a>
				<a class="dropdown-item" href="#">Stop following</a>
				<a class="dropdown-item" href="#">Report</a>
			   </div>
			  </div><!--/ dropdown -->
			  <div class="media m-0">
			   <div class="d-flex mr-3">
			   </div>
			   <div class="media-body">
			    <p class="m-0">{{ row[0] }}</p>
				<small><span><i class="icon ion-md-pin"></i> {{ row[2] }}</span></small><br>
				<small><span><i class="icon ion-md-time"></i> {{ row[6] }} </span></small>
			   </div>
			  </div><!--/ media -->
			 </div><!--/ cardbox-heading -->

			 <div class="cardbox-item">
			  <img class="img-fluid" src="{{ row[1] }}" alt="Image">
			 </div><!--/ cardbox-item -->
			 <div class="cardbox-base">
			  <ul class="fa fa-thumbs-up">
			   <li><a><i class="fa fa-comments" data-target="#comment_appear" type="button" data-toggle="modal"></i></a></li>
			   <li><a><em class="mr-5">aantal comments</em></a></li>
			   <li><a><i class="fa fa-thumbs-up" onclick="like('{{row[3]}}', '{{ group}}')"></i></a></li>
			   <li><a><i class="fa fa-thumbs-down" onclick="dislike('{{row[3]}}', '{{ group}}')"></i></a></li>
			   <li><a><span>likes: {{ row[4] }}</span></a></li>
			  </ul>
			 </div><!--/ cardbox-base -->
			 <div class="cardbox-comments">
			  <span class="comment-avatar float-left">
			  </span>
			  <div class="search">
			   <!--<input placeholder="Write a comment" id="comment-box" type="text">-->
			   <form action="{{ url_for('comment') }}">
                    <fieldset>
                        <div class="form-group">
                            <input class="form-control" name="comments" placeholder="Write a comment" type="text"/>
                        </div>
                        <div class="form-group">
                            <input class="form-control" name="pic" value="{{ row[3] }}"  type="hidden"/>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-default" type="submit">Place comment</button>
                        </div>
                    </fieldset>
                    </form>
			   <!--<span><button><i id = "gifsearch"class="fa fa-camera"></i></button> <button><i id="submit-comment"></i></button></span>-->

			  </div><!--/. Search -->
			 </div><!--/ cardbox-like -->

			</div><!--/ cardbox -->

        </div><!--/ col-lg-6 -->
		   <!--/ col-lg-3 -->

      </div><!--/ row -->
    </div><!--/ container -->
</section>
<!--<img src="{{ row[1] }}" style ="border: 1px solid #000; max-width:300px; max-height:400px display: block; margin-left: auto; margin-right: auto; text-align: center;"/>-->
<!--<label for="toggle-1"></label>-->
<!--<h4>{{ row[2] }}</h4>-->
<!--<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>-->
<!--<div class="form-group">-->
<!--<input id = "comment" autocomplete="off" autofocus class="form-control" name="comment" placeholder="comment" type="text"/>-->


<!--<input type = "text" id = "form-value"autocomplete="off" placeholder="search for gif" type="text"/>-->
<!--<button type="submit" class="search_button"> search </button>-->
<!--<input type="reset" id="reset_button" value="Reset">-->
<!--<input id = "gif" name = "gif" <img id="here_is_gif" src=""/>-->
<!--<form id="like" action="/application.py">-->
<!--  <button name="like" type="submit">Like</button>-->
<!--</form>-->
<!--<form id="dislike" action="/application.py">-->
<!--  <button name="dislike" type="submit">Dislike</button>-->
<!--</form>-->

<script>
      $( document ).ready(function(){

      // Part 1 - Collect User Input Using jQuery Click Listener note we use the class (.) of search_button
      $('.search_button').on('click', function(){

        // Collect user by grabbing the input form's value via id (#)
        var userInput = $('#form-value').val().trim();

        // Change the input to suit the API (ie change spaces to +)
        userInput = userInput.replace(/ /g, "+");

       var queryURL = 'https://api.giphy.com/v1/gifs/search?q=' + userInput + '&api_key=fxVVpisTMf7gev7hUdH22OjTT5Axp7z9';
       //request.open('GET', 'queryURL');

      // Part 2 - Use AJAX to call GIPHY API (note that the .done() function waits for the API to respond)
        $.ajax({url: queryURL, method: 'GET'}).done(function(response){

          // This is the API response data. It's a JSON object of 25 gifs
          console.log(response.data);

          // For simplicity, we will take the first gif (ie. at postion 0)
          var giphyURL = response.data[0].images.fixed_height.url;
          console.log(giphyURL)

          // Now you can pass that into your "here_is_gif" <img> tag using its id (#)
          $('#here_is_gif').attr('src', giphyURL);

        });

        // Part 3 - Clear the Gif using the reset_button id (#)
        $('#reset_button').on('click', function(){
          // Grab the img using the id and change the src to empty to remove the image
          $('#here_is_gif').attr("src",'');
        })


        // If using a jQuery click listner on a Submit button, you need to return false to prevent the default page refresh
        return false;
      })


    });
</script>


<div class="modal fade" id="comment_appear" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Comments</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">

        <table border="0">
{% for line in row[5] %}
            <tr>

                <td colspan="20%">
                    <b>{{ line[0] }}:
                </td>
                <td colspan="80%">
                    {{ line[1] }}
                </td>
               {% endfor %}
            </tr>

        </table>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

{% endfor %}

{% endblock %}